(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[17],{"8I8Z":function(e,t,a){e.exports={tableList:"antd-pro\\github.com\\linthan\\gocron\\web\\react\\src\\pages\\-task\\-log-tableList",tableListOperator:"antd-pro\\github.com\\linthan\\gocron\\web\\react\\src\\pages\\-task\\-log-tableListOperator",tableListForm:"antd-pro\\github.com\\linthan\\gocron\\web\\react\\src\\pages\\-task\\-log-tableListForm",submitButtons:"antd-pro\\github.com\\linthan\\gocron\\web\\react\\src\\pages\\-task\\-log-submitButtons",taskResult:"antd-pro\\github.com\\linthan\\gocron\\web\\react\\src\\pages\\-task\\-log-taskResult"}},IKwF:function(e,t,a){"use strict";var l=a("TqRt"),r=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.FormItem=void 0,a("2qtc");var n=l(a("kLXV"));a("IzEo");var u=l(a("bx4M"));a("P2fV");var d=l(a("NJEC"));a("Pwec");var o=l(a("CtXQ"));a("14J3");var s=l(a("BMrR"));a("jCWc");var c=l(a("kPKH"));a("giR+");var i=l(a("fyUT")),f=l(a("MVZn"));a("+L6B");var m=l(a("2/Rp"));a("Awhp");var p=l(a("KrTs")),g=l(a("lwsE")),h=l(a("W8MJ")),v=l(a("a1gu")),b=l(a("Nsbk")),k=l(a("7W2i"));a("OaEy");var E=l(a("2fM7"));a("5NDa");var y=l(a("5rEg"));a("y8nQ");var w,R,I,S=l(a("Vl3Y")),L=r(a("q1tI")),M=a("MuoO"),V=l(a("wd/R")),F=l(a("BNNL")),_=l(a("zHco")),x=(l(a("usdK")),l(a("8I8Z"))),C=a("OsYT"),T=S.default.Item;t.FormItem=T;y.default.TextArea;var O=E.default.Option,D=function(e){return Object.keys(e).map(function(t){return e[t]}).join(",")},N=(w=(0,M.connect)(function(e){var t=e.tasklog,a=e.loading;return{tasklog:t,loading:a.effects["tasklog/fetch"]}}),R=S.default.create(),w(I=R(I=function(e){function t(){var e,a;(0,g.default)(this,t);for(var l=arguments.length,r=new Array(l),n=0;n<l;n++)r[n]=arguments[n];return a=(0,v.default)(this,(e=(0,b.default)(t)).call.apply(e,[this].concat(r))),a.state={modalVisible:!1,formValues:{},pagination:{},currentTaskResult:{}},a.showTaskResult=function(e){a.setState({currentTaskResult:{result:e.result,command:e.command},modalVisible:!0})},a.columns=[{title:"ID",dataIndex:"id"},{title:"\u4efb\u52a1ID",dataIndex:"task_id"},{title:"\u4efb\u52a1\u540d\u79f0",dataIndex:"name"},{title:"\u6267\u884c\u65b9\u5f0f",dataIndex:"protocol",render:function(e){return C.protocolMap[e]?C.protocolMap[e]:e}},{title:"\u4efb\u52a1\u8282\u70b9",dataIndex:"hostname",render:function(e){return e&&e.split("<br>").map(function(e){return L.default.createElement("div",{key:e},e)})}},{title:"\u6267\u884c\u65f6\u957f",render:function(e,t){return L.default.createElement("div",null,L.default.createElement("div",null,"\u6267\u884c\u65f6\u957f: ",t.total_time>0?t.total_time:1,"\u79d2"),L.default.createElement("div",null," \u5f00\u59cb\u65f6\u95f4: ",(0,V.default)(t.start_time).format("YYYY-MM-DD HH:mm:ss")),L.default.createElement("div",null," \u7ed3\u675f\u65f6\u95f4: ",(0,V.default)(t.end_time).format("YYYY-MM-DD HH:mm:ss")))}},{title:"\u72b6\u6001",dataIndex:"status",width:"8%",render:function(e){switch(e){case 0:return L.default.createElement(p.default,{status:"error",text:"\u5931\u8d25"});case 1:return L.default.createElement(p.default,{status:"processing",text:"\u6267\u884c\u4e2d"});case 2:return L.default.createElement(p.default,{status:"success",text:"\u6210\u529f"});case 3:return L.default.createElement(p.default,{status:"warning",text:"\u53d6\u6d88"})}return e}},{title:"\u64cd\u4f5c",render:function(e,t){return L.default.createElement(L.Fragment,null,2===t.status?L.default.createElement(m.default,{onClick:function(){a.showTaskResult(t)},style:{marginRight:6},type:"primary",icon:"check"},"\u67e5\u770b\u7ed3\u679c"):0==t.status?L.default.createElement(m.default,{onClick:function(){a.showTaskResult(t)},style:{marginRight:6,backgroundColor:"#e6a23c",borderColor:"#e6a23c"},icon:"warning"},"\u67e5\u770b\u7ed3\u679c"):null,1===t.status&&2===t.protocol?L.default.createElement(m.default,{type:"danger"},"\u505c\u6b62\u4efb\u52a1"):null)}}],a.getSearch=function(){var e=a.props.location,t=e.search,l=void 0===t?"":t,r=l&&l.substring(1)||"",n=new URLSearchParams(r);return n},a.getParam=function(){var e=a.state,t=e.formValues,l=e.pagination,r=void 0===l?{}:l,n=a.getSearch(),u=n.get("task_id"),d={page:r.current||1,page_size:r.pageSize||20};return u&&(d["task_id"]=parseInt(u,10)),d=(0,f.default)({},d,t),d},a.handleStandardTableChange=function(e,t,l){var r=a.props.dispatch,n=a.state.formValues,u=Object.keys(t).reduce(function(e,a){var l=(0,f.default)({},e);return l[a]=D(t[a]),l},{});a.setState({pagination:e});var d=(0,f.default)({page:e.current,page_size:e.pageSize},n,u);l.field&&(d.sorter="".concat(l.field,"_").concat(l.order)),r({type:"tasklog/fetch",payload:d})},a.handleFormReset=function(){var e=a.props,t=e.form,l=e.dispatch;t.resetFields(),a.setState({formValues:{}}),l({type:"tasklog/fetch",payload:{}})},a.handleSearch=function(e){e.preventDefault();var t=a.props,l=t.dispatch,r=t.form;r.validateFields(function(e,t){if(!e){var r=(0,f.default)({},t,{updatedAt:t.updatedAt&&t.updatedAt.valueOf()});a.setState({formValues:r}),l({type:"tasklog/fetch",payload:(0,f.default)({},r)})}})},a.handleModalVisible=function(e){a.setState({modalVisible:!!e})},a.renderForm=function(){var e=a.props.form,t=e.getFieldDecorator;return L.default.createElement(S.default,{onSubmit:a.handleSearch,layout:"inline"},L.default.createElement(s.default,{gutter:{md:8,lg:24,xl:48}},L.default.createElement(c.default,{md:4,sm:24},L.default.createElement(T,{label:"\u4efb\u52a1ID"},t("task_id")(L.default.createElement(i.default,{style:{width:"100%"},placeholder:"\u8bf7\u8f93\u5165"})))),L.default.createElement(c.default,{md:4,sm:24},L.default.createElement(T,{label:"\u6267\u884c\u65b9\u5f0f"},t("protocol")(L.default.createElement(E.default,{style:{width:"100%"},placeholder:"\u6267\u884c\u65b9\u5f0f"},C.protocolList.map(function(e){return L.default.createElement(O,{key:e[0],value:e[0]},e[1])}))))),L.default.createElement(c.default,{md:4,sm:24},L.default.createElement(T,{label:"\u72b6\u6001"},t("status")(L.default.createElement(E.default,{style:{width:"100%"},placeholder:"\u72b6\u6001"},C.runStatusList.map(function(e){return L.default.createElement(O,{key:e[0],value:e[0]},e[1])}))))),L.default.createElement(c.default,{md:6,sm:24},L.default.createElement("span",{className:x.default.submitButtons},L.default.createElement(m.default,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),L.default.createElement(m.default,{style:{marginLeft:8},onClick:a.handleFormReset},"\u91cd\u7f6e")))))},a}return(0,k.default)(t,e),(0,h.default)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.dispatch,a=e.form,l=this.getSearch(),r=l.get("task_id");r&&a.setFieldsValue({task_id:parseInt(r,10)}),t({type:"tasklog/fetch",payload:this.getParam()})}},{key:"render",value:function(){var e=this,t=this.props,a=t.tasklog,l=void 0===a?{}:a,r=t.loading,s=t.dispatch,c=l.data,i=void 0===c?{}:c,f=this.state,p=f.modalVisible,g=f.currentTaskResult;return L.default.createElement(_.default,{title:"\u4efb\u52a1\u65e5\u5fd7"},L.default.createElement(u.default,{bordered:!1},L.default.createElement("div",{className:x.default.tableList},L.default.createElement("div",{className:x.default.tableListForm},this.renderForm()),L.default.createElement("div",{className:x.default.tableListOperator},L.default.createElement(d.default,{title:"\u786e\u5b9a\u6267\u884c\u6b64\u64cd\u4f5c?",onConfirm:function(){console.log("clear"),s({type:"tasklog/cleanLog",callback:function(){s({type:"tasklog/fetch",payload:e.getParam()})}})},icon:L.default.createElement(o.default,{type:"question-circle-o",style:{color:"red"}})},L.default.createElement(m.default,{icon:"close",type:"danger"},"\u6e05\u7a7a\u65e5\u5fd7"))),L.default.createElement(F.default,{loading:r,data:i,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))),L.default.createElement(n.default,{width:720,title:"\u4efb\u52a1\u6267\u884c\u7ed3\u679c",onOk:function(){e.handleModalVisible(!1)},onCancel:function(){return e.handleModalVisible(!1)},visible:p}," ",L.default.createElement("div",null,L.default.createElement("pre",{className:x.default.taskResult},g.command)),L.default.createElement("div",null,L.default.createElement("pre",{className:x.default.taskResult},g.result))))}}]),t}(L.PureComponent))||I)||I),Y=N;t.default=Y}}]);